[pytest]
# PDFium Test Configuration

# Test discovery
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Output
console_output_style = progress
log_cli = false

# Options
addopts =
    -ra
    --strict-markers
    --tb=short
    -v

# Markers
markers =
    timeout: Test timeout in seconds (no-op without pytest-timeout plugin)
    smoke: Quick smoke tests (67 tests, ~7 minutes) - Run before every commit
    corpus: Full PDF corpus validation (963 tests, ~24 minutes) - All 452 PDFs × 3 tests + edge cases
    smoke_fast: Ultra-fast smoke test subset (< 1 min, for git hooks)
    infrastructure: Test infrastructure verification (file existence, hashes)
    text: Text extraction tests
    jsonl: JSONL extraction tests (character-level metadata)
    image: Image rendering tests
    correctness: Correctness validation tests
    performance: Performance benchmark tests
    scaling: Worker scaling analysis tests
    stability: Determinism and stability tests
    interface_benchmarks: Interface benchmarking study (single-core vs multi-process analysis)
    comprehensive: Comprehensive benchmarking tests (20m+)
    batch_bulk: Batch processing tests
    edge_cases: Edge case and malformed PDF tests
    standard_60_set: Standard 60-PDF test corpus
    arxiv: Academic papers from arXiv
    cc: Common Crawl web content
    edinet: Japanese corporate filings (EDINET)
    web: Web-converted documents
    japanese: Japanese language PDFs
    pages: Page-numbered PDFs
    benchmark: Benchmark PDFs (generic category)
    small_pdf: Small PDFs (< 100 pages)
    medium_pdf: Medium PDFs (100-199 pages)
    large_pdf: Large PDFs (200+ pages)
    unknown_pdf: PDFs with unknown size classification
    api: API mode tests (--bulk, --fast, --debug)
    smart: Smart mode tests (quick smoke tests for --smart flag)
    smart_pdf: Smart scanned PDF optimization tests (JPEG→JPEG fast path)
    cpp_cli: C++ CLI validation tests (pdfium_cli correctness vs Rust tools)
    threading: Threading and thread-safety regression tests
    determinism: Multi-run determinism validation tests
    regression: Specific regression tests for known issues
    v1_6_0: v1.6.0 feature validation tests (progress reporting, batch processing, error messages)
    v1_9_0: v1.9.0 feature validation tests (smart presets, BGR mode)
    gpu: GPU acceleration tests (Metal backend on macOS)
    memory: Memory usage validation tests
    streaming: Streaming architecture tests (on-demand page loading)
