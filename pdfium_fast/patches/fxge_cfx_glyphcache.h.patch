--- pdfium/core/fxge/cfx_glyphcache.h	2025-11-20 14:44:25
+++ core/fxge/cfx_glyphcache.h	2025-12-03 16:39:54
@@ -7,8 +7,10 @@
 #ifndef CORE_FXGE_CFX_GLYPHCACHE_H_
 #define CORE_FXGE_CFX_GLYPHCACHE_H_
 
+#include <atomic>
 #include <map>
 #include <memory>
+#include <mutex>
 #include <tuple>
 
 #include "core/fxcrt/bytestring.h"
@@ -48,6 +50,11 @@
 
   RetainPtr<CFX_Face> GetFace() { return face_; }
 
+  // Enable/disable read-only mode for lock-free parallel text extraction
+  void SetReadOnlyMode(bool mode) {
+    read_only_mode_.store(mode, std::memory_order_release);
+  }
+
 #if defined(PDF_USE_SKIA)
   CFX_TypeFace* GetDeviceCache(const CFX_Font* font);
   static void InitializeGlobals();
@@ -84,6 +91,17 @@
                                      int dest_width,
                                      int anti_alias);
   RetainPtr<CFX_Face> const face_;
+
+  // Thread-safety: Protects all map access for concurrent rendering.
+  // Multiple threads may call LoadGlyphBitmap(), LoadGlyphPath(), and
+  // GetGlyphWidth() simultaneously, requiring synchronized map operations.
+  mutable std::mutex cache_mutex_;
+
+  // Read-only mode flag for lock-free parallel text extraction
+  // After pre-warming, all glyphs are cached and map access is read-only
+  // C++ ยง26.2.5.1 guarantees map::find() is thread-safe without modification
+  std::atomic<bool> read_only_mode_{false};
+
   std::map<ByteString, SizeGlyphCache> size_map_;
   std::map<PathMapKey, std::unique_ptr<CFX_Path>> path_map_;
   std::map<WidthMapKey, int> width_map_;
