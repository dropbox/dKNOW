--- pdfium/core/fxge/cfx_face.h	2025-11-20 14:44:25
+++ core/fxge/cfx_face.h	2025-12-03 16:39:54
@@ -9,13 +9,13 @@
 
 #include <array>
 #include <memory>
+#include <mutex>
 #include <optional>
 #include <vector>
 
 #include "build/build_config.h"
 #include "core/fxcrt/bytestring.h"
 #include "core/fxcrt/fx_coordinates.h"
-#include "core/fxcrt/fx_stream.h"
 #include "core/fxcrt/observed_ptr.h"
 #include "core/fxcrt/retain_ptr.h"
 #include "core/fxcrt/span.h"
@@ -65,17 +65,12 @@
                                  pdfium::span<const FT_Byte> data,
                                  FT_Long face_index);
 
-#if defined(PDF_ENABLE_XFA)
-  static RetainPtr<CFX_Face> OpenFromStream(
-      FT_Library library,
-      const RetainPtr<IFX_SeekableReadStream>& font_stream,
-      FT_Long face_index);
+#if BUILDFLAG(IS_ANDROID) || defined(PDF_ENABLE_XFA)
+  static RetainPtr<CFX_Face> Open(FT_Library library,
+                                  const FT_Open_Args* args,
+                                  FT_Long face_index);
 #endif
-#if BUILDFLAG(IS_ANDROID)
-  static RetainPtr<CFX_Face> OpenFromFilePath(FT_Library library,
-                                              ByteStringView path,
-                                              int32_t face_index);
-#endif
+
   bool HasGlyphNames() const;
   bool IsTtOt() const;
   bool IsTricky() const;
@@ -146,17 +141,10 @@
 
   bool SetPixelSize(uint32_t width, uint32_t height);
 
-#if defined(PDF_ENABLE_XFA)
-  int GetNumFaces() const;
-#endif
-
 #if BUILDFLAG(IS_WIN)
   bool CanEmbed();
 #endif
 
-  bool HasFaceRec() const { return !!GetRec(); }
-
-  // TODO(crbug.com/460068801): Make these private.
   FXFT_FaceRec* GetRec() { return rec_.get(); }
   const FXFT_FaceRec* GetRec() const { return rec_.get(); }
 
@@ -166,18 +154,14 @@
 
   void AdjustVariationParams(int glyph_index, int dest_width, int weight);
   std::optional<std::array<uint8_t, 2>> GetOs2Panose();
-#if BUILDFLAG(IS_ANDROID) || defined(PDF_ENABLE_XFA)
-  static RetainPtr<CFX_Face> Open(FT_Library library,
-                                  const FT_Open_Args* args,
-                                  FT_Long face_index);
-#endif
 
-  // `owned_font_stream_` must outlive `owned_stream_rec_`.
-  RetainPtr<IFX_SeekableReadStream> owned_font_stream_;
-  // `owned_stream_rec_` must outlive `rec_`.
-  std::unique_ptr<FXFT_StreamRec> owned_stream_rec_;
   ScopedFXFTFaceRec const rec_;
   RetainPtr<Retainable> const desc_;
+
+  // Thread safety: FreeType FT_Face is NOT thread-safe.
+  // All FT_* calls on the same face must be serialized.
+  // See: https://freetype.org/freetype2/docs/reference/ft2-thread_safety.html
+  mutable std::mutex face_mutex_;
 };
 
 #endif  // CORE_FXGE_CFX_FACE_H_
