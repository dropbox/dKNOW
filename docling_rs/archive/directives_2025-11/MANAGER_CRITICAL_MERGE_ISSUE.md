# [MANAGER] CRITICAL - Merge Broke PDF Backend

**Date:** 2025-11-24 09:00 AM
**Severity:** CRITICAL
**Issue:** Cargo.toml merge conflict resolution broke the build

---

## PROBLEM: pdf-ml Feature Not Defined

### What Happened

**During merge conflict resolution:**
- I resolved crates/docling-backend/Cargo.toml by taking main's version
- Main's Cargo.toml does NOT have pdf-ml feature defined
- But pdf.rs code references #[cfg(feature = "pdf-ml")]

**Result:**
```rust
// pdf.rs references feature that doesn't exist
#[cfg(feature = "pdf-ml")]  // ← Feature not in Cargo.toml!
{
    // ML code
}
```

**Compilation error:**
```
error: unexpected `cfg` condition value: `pdf-ml`
= note: expected values for `feature` are: `async`, `default`, and `tokio`
= help: consider adding `pdf-ml` as a feature in `Cargo.toml`
```

---

## Root Cause

**Merge conflict on Cargo.toml:**
- Feature branch had: pdf-ml feature + docling-pdf-ml dependency
- Main had: No pdf-ml feature
- I resolved by taking main's version (WRONG)
- Should have merged BOTH versions

---

## Impact

**PDF Backend is BROKEN on main:**
- pdf-ml feature undefined
- docling-pdf-ml dependency missing
- parse_bytes() always takes error path
- PDF parsing doesn't work

**This is a CRITICAL regression.**

---

## Fix Required

**Must add to crates/docling-backend/Cargo.toml:**

```toml
[dependencies]
docling-pdf-ml = { version = "2.58.0", path = "../docling-pdf-ml", optional = true }

[features]
pdf-ml = ["docling-pdf-ml", "docling-pdf-ml/pytorch"]
```

**Then rebuild:**
```bash
cargo build -p docling-backend --features pdf-ml
```

---

## How This Happened

**Manager error during conflict resolution:**
1. Saw 3 conflicts (FORMAT_PROCESSING_GRID, README, Cargo.toml)
2. Used git checkout --theirs (took main's version)
3. Didn't verify Cargo.toml needed both branches merged
4. Main's version had NO pdf-ml feature
5. Code referencing pdf-ml feature now breaks

**Should have:**
- Manually merged Cargo.toml
- Added pdf-ml feature from feature branch
- Verified build after merge

---

## Current State

**Code:** ✅ All ML code merged
**Integration:** ✅ pdf.rs uses ML
**Cargo.toml:** ❌ **BROKEN** - missing feature definition
**Build:** ❌ **FAILS** - undefined feature
**Tests:** ❌ **CAN'T RUN** - won't compile

---

**USER WAS RIGHT TO BE SKEPTICAL**

We are NOT at 100% perfection. The merge broke the build.

**Fix needed:** 5 minutes (add feature to Cargo.toml)

---

**Generated by:** Manager AI
**Purpose:** Critical bug report
**Action:** Fix Cargo.toml immediately
