/// Test that chrome.runtime.id is different for multiple extensions
    func testChromeRuntimeIdMultipleExtensions() async throws {
        // Create two different extensions
        let extension1 = createTestBrowserExtension(name: "Extension 1")
        let extension2 = createTestBrowserExtension(name: "Extension 2")
        
        // Create webview
        let webView = AsyncWKWebView()
        
        // Activate both extensions
        await manager.activate(extension1)
        await manager.activate(extension2)

        // Register webview (this adds the user scripts)
        try await manager.registerWebView(
            webView,
            userContentManager: BrowserExtensionUserContentManager(
                userContentController: webView.be_configuration.be_userContentController,
                userScriptFactory: BrowserExtensionUserScriptFactory()),
            role: .userFacing)

        // Load HTML - user scripts will be injected during this load
        let html = "<html><body>Test</body></html>"
        try await webView.loadHTMLStringAsync(html, baseURL: nil)
        
        // Wait for user scripts to take effect
        try await Task.sleep(nanoseconds: 100_000_000) // 100ms
        
        // Get content worlds
        let activeExtension1 = manager.activeExtension(for: extension1.id)!
        let activeExtension2 = manager.activeExtension(for: extension2.id)!
        let contentWorld1 = activeExtension1.contentWorld
        let contentWorld2 = activeExtension2.contentWorld
        
        // Check chrome.runtime.id in first extension's world
        let result1 = try await webView.callAsyncJavaScript("""
            return chrome.runtime.id;
        """, contentWorld: contentWorld1) as? String
        
        // Check chrome.runtime.id in second extension's world
        let result2 = try await webView.callAsyncJavaScript("""
            return chrome.runtime.id;
        """, contentWorld: contentWorld2) as? String
        
        XCTAssertEqual(result1, extension1.id.stringValue)
        XCTAssertEqual(result2, extension2.id.stringValue)
        XCTAssertNotEqual(result1, result2)
        
        // Cleanup
        manager.unregisterWebView(webView)
    }