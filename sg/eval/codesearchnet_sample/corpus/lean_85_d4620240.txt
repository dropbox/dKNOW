/-- Use the command state in the given snapshot to run a `CommandElabM`.-/
def runCommandElabM (snap : Snapshot) (doc : DocumentMeta) (c : CommandElabM Î±) : EIO Exception Î± := do
  let ctx : Command.Context := {
    cmdPos := snap.stx.getPos? |>.getD 0,
    fileName := doc.uri,
    fileMap := doc.text,
    snap? := none
    cancelTk? := none
  }
  c.run ctx |>.run' snap.cmdState